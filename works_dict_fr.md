### Используемые понятия

1. **Наименование работы** - обозначение для строительной работы, доступной в данной шахматке (доступной к исполнению на объекте).
2. **Группа работ** или **Вид работ** - несколько наименований работ, объединенных пользователем по какому-то принципу. Отображается в UI как папка. Сейчас система позволяет создавать только один уровень вложенности, по бизнесу соответствующий "Виду работ". Для большей вложенности более корректным названием для папки будет группа работ.
3. **Работа** (таска) - задача по проведению конкретного наименования работ, для данного исполнителя, в определенном помещении.
4. **Список работ** - название раздела web-приложения, отвечающего за настройку переченя работ в шахматке (работ на объекте).
5. **Пользовательский список работ** - перечень наименований работ, доступных данному пользователю. Из них пользователь выбирает наименования работ для своих шахматок. (имеет смысл сделать его всесистемным!)
6. **Список работ шахматки** - перечень наименований работ данного объекта (шахматки).
7. **Дефолтный список работ** - универсальный стартовый шаблон, порождающий пользовательский список работ на старте взаимодействия пользователя с системой.

### Макеты

1. [Стартовый экран - список работ шахматки не настроен](https://app.zeplin.io/project/63189e67cde56b49dacec5e2/screen/63d101a3db0baa7996b68f10):
    - слева - **область пользовательских работ**;
    - справа - **область работ шахматки**.
2. [Список работ шахматки настроен](https://app.zeplin.io/project/63189e67cde56b49dacec5e2/screen/63d101a7f602847abe046714).

### Предложения по БД

1. Определить таблицу work под под список работ шахматки.  
2. Новую таблицу (в духе user_work_list) создать под пользовательский список работ.

> Если привязывать работу к user_work_list вместо work, то при удалении наименования работы из списка работ шахматки (из таблицы work) работа (task) все еще будет ссылаться на корректное наименование, данные не потеряются. Получится что-то вроде soft-delete. Когда работа ушла отдыхать в user_work_list, при ее добавлении обратно все работы заресторятся, как было...
> Но во-первых мы не хотим перегружать логику.  
> Во-вторых, у нас будет версионирование и откат. Так что удаляем жестко.

> Все же необходимо дать возможность откорректировать наименования? Тогда любой мой редактор может поменять мне название работы. Давайте мы лучше их всех будем хранить, пусть и с ошибками? Но с другой стороны откатиться всегда можно. С первой - ради изменения названия работ откатываться... ну переименуй назад.
> ~~тогда у нас что при закрытии нарядов будет? Работа сменила свое название в какой-то момент - и нас это совершенно не колышит? Это нормально?~~
> Если таска перестанет существовать, то мы рискуем потерять кусок работы в нарядах. Поэтому надо продолжать коллекционировать все таски, какие бывали в этой комнате. Из боковой панели до удаленной работы мы больше тупо не сможем доступиться... А вот из нарядов сможем - почему бы и нет. Тогда у работы должен быть либо дополнительный статус "Удалена" (но статус таски - это ж немного про другое), поэтому предлагается просто нафиг их удалять. Если пользователю очень надо, пусть держит таску дальше. Удалил - сам дурак.

### Функциональные требования

1. Пользователь-"Чтение" может:
    1. просматривать список работ шахматки.
        1. все элементы управления (кнопки, чекбоксы, пр.) для него залочены.
    2. просматривать пользовательский список работ владельца шахматки:
        1. все элементы управления (кнопки, чекбоксы, пр.) для него залочены;
    3. скопировать к себе в шахматки список работ из чужой шахматки, к которой есть доступ. Пользовательский список в общем считаем системным, сквозным.
2. Пользователь-"Владелец" и пользователь-"Редактор" могут совершать эквивалентные действия по отношению к списку работ шахматки.
3. Пользователь-"Редактор" видит при настройке чужой шахматки чужой пользовательский список (список владельца).
4. Каждый пользователь может управлять своим пользовательским списком только при работе в своих шахматках.
5. Пользователь-"Владелец" и пользователь-"Редактор" могут:
    1. просматривать **список работ шахматки**:
        1. список работ шахматки поддерживает иерархическую структуру - пока доступен только один уровень вложенности папок (ранее это был "вид работ"; "этапов" больше нет).
    2. просматривать **пользовательский список работ** владельца шахматки:
        1. пользовательский список работ является плоским списком без иерархии.            
    3. выбирать одну или несколько наименований работ в пользовательском списке работ для массового добавления в список шахматки;
        1. после успешного переноса наименования работы из пользовательского списка работ в Список работ шахматки:
                1. перемещенное наименование работы попадает в корень струтуры "Список работ шахматки";
                2. при переносе работы она перестает отображаться в старой области и начинает отображаться в новой;
                3. старые галки чекбоксов в списке работ шахматки остаются, какими были;
                4. только что добавленным в шахматку работам проставляются незаполненные чекбоксы.
    4. выбирать одну или несколько наименований работ в списке работ шахматки (для удаления, для перемещения):
        1. при удалении: если наименование работ используется в шахматке (есть связанные с ним работы), возникает модальное окно "Внимание! Все равно удалить?". При согласии:
            1. Из таблицы work соответствующие наименования работ удаляются.
            2. Из таблицы task соответствующие работы удаляются.
            3. Работа по-настоящему (из таблицы user_work_list) удаляться не умеет - user_work_list хранит их все! Кривые, косые, с ошибками. Только дублей там быть не может, забегая вперед.
            4. Если папка "Вид работ" в списке работ шахматки:
                1. пустая, то по нажатии на кнопку "Удалить" она удаляется;
                2. имеет внутри себя хотя бы одно наименование работ, то при нажатии на кнопку "Удалить" удаляется содержимое папки.
            5. после успешного переноса наименования работы из шахматки в пользовательский список работ (aka "Удаление"):
                1. при переносе работы она перестает отображаться в старой области и начинает отображаться в новой;
                2. старые галки чекбоксов в пользовательском списке остаются, какими были;
                3. только что удаленным из шахматки работам проставляются незаполненные чекбоксы.
        2. при перемещении: переносить наименования работ в списке шахматки между разными уровнями вложенности:
            1. из произвольной комбинации расположений в группу работ на выбор (в папку);
            2. из произвольной комбинации расположений в корень.
            3. в частности, одна работу пользователь может перенести:
                1. из одной группы работ в другую;
                2. из корня в группу работ;
                3. из группы работ в корень.
        3. Если выбраны все наименования в списке работ шахматки, относящиеся к одному виду работ (к одной "папке") - проставляется чекбокс у папки;
        4. Если выбран хотя бы один элемента внутри папки, у папки проставляется состояние чекбокса "-";
        5. Если не выбрано ни одного элемента внутри папки, чекбокс у папки не проставлен.
        6. Если выбирана группа работ (папка):
            1. проставляются чекбоксы всем наименованиям работ внутри папки.
        7. Если снимается выделение с группы работ (папки):
            1. снимаются чекбоксы со всех наименований работ внутри папки.
    5. если в списке работ шахматки выбрано несоколько чекбоксов с работами или видами работ, это никак не влияет на процессы:
        1. при работе с кнопкой "Создать" ("Работу", "Вид работ");
        2. при работе с кнопкой "Список" ("Клонирование списка работ из другой шахматки", "Экспортировать в файл (xlsx)", "Импортировать из файла", "Очистить список")
    6. система никак не препятствует сводобному выбору работ одновременно в двух частях экрана - это разные списки;
    7. создавать новую работу непосредственно в списке шахматки:
        1. имя новой работы уникально для списка работ пользователя (и, соответственно, его подмножества - списка работ шахматки).
    8. создавать новую пустую группу работ (папку) в списке работ шахматки:
        1. имя новой группы работ уникально для списка работ шахматки.
    9. Раскрытая папка визуально отличается от свернутой.
    10. Пользователи ("Владелец" и "Редактор") могут осуществлять быстрый поиск/фильтрацию по работам:
        1. в списке пользователя по таблице user_work_list
        2. в списке шахматки по таблице work
        3. поиск начиначется после ввода 1 символа
    9. Копировать список работ если у него есть хоть какой-то доступ к шахматке. Берутся работы справа. Левая часть у всех общая по системе
6. В ряде случаев возникают нотификации:
    1. когда для пользователя залочены кнопки ("Чтение"), нажание на любую из них генерирует обратную связь;
    2. при нажатии на кнопку "Удалить", если не выбрана ни одна работа, ошибка;
    3. при нажатии на кнопку "Переместить", если не выбрана ни одна работа, ошибка.
7. Первый вход в раздел "Список работ":
    1. При создании нового пользователя для него создается сущность "пользовательский список работ" и в него кладется "дефолтный список работ" (сам список тут).
    2. При переходе в шахматку: если список работ этой шахматки не настроен, система предлагает пользователю его настроить (создать), т.е. для каждой шахматки пользователь создает отдельный список работ шахматки.
    3. При переходе в шахматку: если список работ этой шахматки настроен, пользователь может отредактировать список работ шахматки.
    4. По дефолту на старте настройки "Списка работ" пользователь-"Владелец" видит в области дефолтного справочника наименования работ, 

### Функциональные требования на потом

1. Пользователь может редактировать наименования работ (внутри справочника работ шахматки или внутри пользовательского списка работ) Редактировать работы пока что никто не может
2. Пользователь может удалять наименования работ.
3. У пользователя не может быть 0 объектов (шахматок):
    - пользователь на старте работы всегда получает демо-проект;
        - при создании демо-проекта в его шахматку в список работ кладется дефолтный список работ (**ссылка на данные**).
    - пользователь может создавать новые объекты;
    - пользователь может удалять свои объекты, если их больше 1 (корзинка?);
    - пользователь не может удалить последний объект (шахматку).
4.     - редактировать работы внутри справочника работ шахматки 
когда прокручиваем вниз список работ, кнопки по удалению-добавлению лучше бы прилипали бы
драг-н-дроп для перемещения





### User Stories

1. 
2. 

### Use-cases

1. 
2. 

### Дополнительные материалы:

1. Дефолтный список работ для пользователя (плоский). - тут ссылка на файл.
