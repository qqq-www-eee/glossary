# Пользователи, исполнители, должности, доступы, приглашения

<br>

## Введение (проблематика):

> В бизнес-логике системы представлены сущности, которые не являются зарегистрированными (авторизованными) пользователями, а являются, скорее, **контактами** (dummy-пользователями, кандидатами в пользователи, неавторизованными пользователями). И **контакты**, и **пользователи** соответствуют реальным людям - в частности, обязаны иметь атрибуты "ФИО" и "Телефон".
>   - **Контактами** могут являться исполнители и технадзоры, которых просто внесли в списки шахматок "Исполнители" и "Технадзоры", но которые сами еще не являются пользователями (т.е., это "атрибут" шахматки).  
>
>   - **Пользователями** могут являться прорабы и технадзоры, ведущие операционную деятельность в шахматке ("субъекты" по отношению к шахматке).  
>
> > Отсюда видно, что как минимум **технадзоры не позволяют полностью отделить пользователей от контактов** - список шахматки "Технадзор" не подразумевает подтягивание данных из разных мест БД и сложную логику для их обработки, избежания дублей и т. д.

Решение 1: Разделение
> Минусы решения, в котором всех исполнителей (рабочий, бригадир) причисляют к **Контактам**, а основных пользователей (прораб/мастер участка/технадзор/начальник участка/др.) - к **Пользователям**:
> - вопрос с технадзорами (см. выше);  
> - плодим сущности без надобности;
> - затруднение дальнейшего сбора статистики и анализа; 
> - все равно надо будет вести таблицу, в которой записаны те же исполнители с привязкой к конкретному проекту (шахматке). Объем его будет сопоставим или больше, чем база никнеймов (алиасов): если никнейм в каждом проекте свой, то объем такой же, а если с привязкой только к пользователю - то никнеймы по идее выигрывают.

Решение 2: Единая база, сквозные данных
> Другой вариант - мы вообще не отличаем **пользователей** от **контактов** и храним их в одной таблице в БД. Возникают вопросы:
>   - Кто в праве задавать сквозное имя для пользователя, которого в разных шахматках вписывают в свои списки разные пользователи? Какое имя более правильное - первое или последнее? И так далее.
>   - Нормально ли явление коллективного редактирование имени? Это ведет к:
>     - потере пользовательских данных;
>     - сильной путанице в пользовательском опыте.
>   - Можем ли мы распространять чувствительные данных по фио, телефону, телеграму и т. д.?

## Вывод:

Решение 3: Никнеймы (алиасы)
> - По-видимому, без решения задачи по вводу никнеймов в систему (говорим пока о ФИО и о Должности) не обойтись.  
> - Никнеймы потребовались бы, даже если **контакты** хранить отдельно от **пользователей** - сквозное изменение имен все равно проявилось бы для пользователей (т. е. технадзоров как минимум).  
> - Если потребуется, заодно никнеймы решают проблему доступа к контактным данным (один пользователь видит основной работчий email технадзора, который сам и ввел, другой - личный email, третий - не видит ничего и т. д.);
>
> - Уже есть таблица, связывающая проект и пользователя - **project_role**.  Вероятно, надо будет просто добавить в связь "ФИО данного пользователя в данном проекте" и "Должность данного пользователя в данном проекте".  
> - **Изменения в эту таблицу (или другое место хранения никнеймов) должен вносить только создатель проекта (шахматки)**. 


## Предложения:

### Основные тезисы по типам пользователей:

> - Те **контакты**, которые получили приглашение (инвайт) присоединиться к системе, являются фыжвалдоывжадлофыаждлоыфжвдалоы
> - Один и тот же номер телефона может встречаться в системе много раз - он может быть указан разными пользователями в своих шахматках. 
> - Один и тот же номер телефона может встречаться в рамках одного проекта несколько раз - его могут указать и как технадзора, и как исполнителя - почему нет.
> - В качестве технадзора и исполнителя можно ставить пользователей, а можно - контакты.
> - Делаем таблицу с никнеймами. Потому что если каждому пользователю дать возможность создавать списки с людмьми, которые привязаны к конкретному проекту, у нас будет в этой таблице dummy-пользователей столько дублей, что мы потом и просто никогда не разгребем, если потребуется. Давайте сразу без дублей.
> - Надо сделать таблицу, которая будет содержать отражение реальных пользователей на проект текущего пользователя. Это решит проблему отображений измененных другими пользователями имен.

### Дополнительные тезисы по типам пользователей:


>   - В таблице, хранящей исполнителей, несколько записей может быть связано с одним и тем же человеком. Одноко в рамка одного проекта исполнители (номера телефонов) уникальны, т. е. комбинацией "project_uuid + phone" является для таблицы уникальной (это предложение).
>  
> - Мобильного приложения для рабочего, вероятно, не будет.
> - Доступы необходимо отвязать от должностей пользователей.
> 
> - Не только "ФИО", но и "Должность" пользователя в системе отображаются сквозным образом.
> - Мы не хотим заставлять пользователей вести учет Фамилий, Имен и Отчеств, поэтому предлагается везде в системе перейти к единому полю - "ФИО" - в том числе в разделе "Мой профиль".
> - В одном и том же помещении могут быть замечания, оставленные разными технадзорами (т. е. разными пользователями с доступом редактирования). Какая-либо связь комментирующих пользователей с тем технадзором, который "закреплен" за помещением в шахматке, технически отсутсвтует.
> - Для каждого среза работ должны быть свои замечания. Необходимо предусмотреть переключение между видами работ для замечаниях (нужно решить, хотим мы работу/вид работы отображать на вкладке замечаний уже или хотим изначально навигироваться по работам, а замечания вынести в **Панель действий**). 
> - Замечания очень просятся в панель действий.
> - Технадзор в списках шахматки сразу создается как пользователь, даже если он не подтвердил свое существование...
> - Как только технадзор регистрируется в системе, он должен стать пользователем и быть помещен в таблицу user. Его имя станет сквозным для всех. Какое имя будет отражено у всех, кто его задействовал в своих шахматках? А какую из данных ему кличек он сам увидит у себя?
> - нам необходимы нотификации, которых скажут прорабу, что его технадзор зарегался в системе и теперь его имя изменилось - на такое-то. ??? Или просто ссылку на реального пользователя прикрутим и фиг с ним уже?

#### Основные тезисы по доступам:

> - "Чтение". Приглашенные пользователи с правом "Чтение" могут только **просматривать шахматку** (объемы работ, исполнители, этажи) и **просматривать замечания**. (а как же просматривать справочники и наряды?)
> - "Редактирование". Приглашенные пользователи с правом "Редактирование" могут редактировать шахматку, редактировать справочники, создавать/редактировать/удалять **свои** замечания, **а также менять статусы чужих замечаний**. Могут просматривать доступы.
> - "Владелец". Создатель шахматки может делать все, в том числе редактировать и удалять чужие замечания и настраивать доступы.
> - ~~Важно! Человек сейчас может самовыпилиться из доступов. Давайте у него эту возможность заберем, потому что и так работает непонятно. Более того, давайте мы не будем давать список доступов кому попало даже давать смотреть, как и к справочникам вопросики конечно~~

<br>

**Общая структура доступов**

| Функциональность                | Комментарий                          |
| ------------------------------- | ------------------------------------ |
| Замечания                       | Просмотр чужих замечаний (RE)        |
|                                 | - Смена статуса чужих замечаний (ED) |
|                                 | - - Редактирование чужих замечаний (OW) |
| Шахматки (статусы, объем работ) | Просмотр шахматки (RE)               |
|                                 | - Редактирование шахматки  (ED)      |
| Списки (справочники)            | Просмотр (RE?)                       |
|                                 | - Создание, редактирование, удаление |
| Наряды и реестры                | Просмотр (RE???)                     |
|                                 | - Создание, удаление, просмотр (ED)  |
 
Просматривать и редактировать СВОИ замечания, шахматки, списки (справочники), наряды-реестры пользователь может всегда.
Создание, редактирование (в т. ч. управление файламии), удаление замечаний,

<br>

#### Data base

<br>

> - Необходимо реализовать отедльную таблицу для исполнителей со структурой, похожей на user (см. **worker** ниже).
> - Необходимо отвязать понятие "Должность" от доступов пользователей (role):  
Из таблицы  **project_role** убрать все записи, кроме "Чтение" и "Редактирование". Почти все оставльные строки необходимо вынести в отдельную таблицу с должностями (напр., **user_job_title_d**, справочник, см. ниже) - либо просто иметь ее в виду и создать, когда станет необходима. В этой же таблице **project_role** нужно удалить поле (**status**) (это legacy). 
> - Таблицу **permissions**, вероятно, необходимо дропнуть (role и permissions вдвоем доставляют очень близкий по смыслу функционал регулирования доступов - мы имеем возможность и желание от этого дробления уйти).
> - Таблицу **role_permission**, вероятно, необходимо дропнуть.  
> - В таблице **user** нужно убрать поля gender, status, first_name, middle_name, last_name. Добавить поле full_name (которое можно заполнить конкатенацией из фамилий-имен-отчеств) и добавить поле job_title с uuid должности из справочника **user_job_title_d** (или строка, если не хотим заводить словарь).  
>
> - Предлагается в таблицах **role** ~~и **permission**~~ перейти в айдишниках от _serial4_ в пользу _uuid_.  
> - ~~В будущем у исполнителей может быть словарь из своих должностей: "бригадир" и "рабочий" (пока можно просто иметь в виду)~~.
> - Удалить поле _code_ в таблице **role**, перейти от serial4 к uuid и другие предложения (см. ниже).

<br>

#### Back-end

<br>

> - При сохранении данных из экрана "Моя учетная запись" вместо Фамилии, Имени, Отчества сохранять единое поле "ФИО", а также сохранять новое поле "Должность".
> - Поле "Должность" для пользователя истемы, считаем, работает сквозным образом, как и ФИО.
> - Необходимо добавить возможность корректировки исполнителя в справочнике проекта без удаления строки.

<br>

#### Design + Front-end

<br>

> - В экране редкатировании списка "Исполнители проекта" привести текст, поясняющий, что "Исполнители проекта по умолчанию не имеют доступа к шахматке" либо похожий (предложение);  
> - В экране "Мой профиль": необходимо добавить поле "Должность" на front-end в виде селектора (справочника) с единичным выбором;  
> - В экране "Мой профиль": заменить "Фамилию", "Имя", "Отчество" на одно обязательное поле - "ФИО"  - для предсказуемого с точки зрения пользователя поведения системы. 
> - В экране "Настройка доступов" убрать поле "Роль" - вместо него, если когда потребуется, система будет свкозным образом отображать "Должность" из учетного записи того пользователя или исполнителя.
> - В экране "Редактирование спика ХХХ": когда на проект добавляется новый технадзор или исполнитель, при вводе номера телефона пользователь должен заранее видеть, как зовут в системе этого человека (поиск по таблицам user и worker).
> - Нужны 2 разных компонента для экранов у пользователей с разными доступами - а именно, для функционала "добавления новых записей в справочники из панели действий" в правой части экрана.
> - Необходимо добавить возможность корректировки исполнителя - без удаления строки. Разлочить поля на фронт-енд.
> 

<br>

#### Backlog

<br>


> - Очень хочется, чтобы имя пользователя отражалось где-то, кроме как в экране учетной записи. Но это надо думать в будущем.
> - Пользователь при добавлении кого-то в доступы должен видеть, как звали того, кого он добавляет - но только в рамках этого конкретного проекта.
> - У пользователя Б есть поля - про ФИО. Вот, на основе их, если пользователь Б уже зарегистрирован, а пользователь А впервые вносит его в свои списки - хорошо бы генерировать сразу Фамилию+инициалы для предзаполнения имени исполнителя или технадзора, это если мы не паримся за чувствительность данных.

<br>

## Предложения по изменению в БД:

### Таблица user

_Изменение состава полей_

| Как сейчас:              | Как предлагается сделать:   | Комментарий |
| ------------------------ | --------------------------- | ----------- |
| id                       | id                          |             |
| **first_name**           |                             |             |
| **middle_name**          |                             |             |
| **last_name**            | **full_name**               | not null    |
| email                    | email                       |             |
| phone                    | phone                       |             |
| pic                      | pic                         |             |
| **status**               |                             |             |
| created                  | created                     |             |
| updated                  | updated                     |             |
| last_login               | last_login                  |             |
| **login**                | **(login?)**                |             |
| **pwd**                  | **(pwd?)**                  |             |
| **salt**                 | **(salt?)**                 |             |
| **password_set_by_user** | **(password_set_by_user?)** |             |
| **gender**               |                             |             |
| comment                  | comment    | Комментарий в свободной форме|
| telegram_id              | telegram_id                 |             |
| last_project_id          | last_project_id             |             |
|                          | job_title                   | Вместо таблицы **project_role** |

Человек на двух объектах, тем более в разных должностях - кейс практически нереальный, поэтому можно задать job_title как сквозной атрибут пользователя.

<br> 

### Таблица worker_project (исполнители с привязкой к проекту)

_Новая таблица_

| Как предлагается:   | Комментарий |
| ------------------- | -------------- |
| worker_uuid         | not null       |
| project_uuid        | uuid, not null |
| full_name           | not null       |
| email               |                |
| phone               | not null       |
| telegram_id         |                |
| job_title | "Бригадир" или "Рабочий" |
| comment | Комментарий в свободной форме: "всегда пропадают мешалки", varсhar(255)|
| created             |                |
| updated             |                |

1. Рабочий может быть записан исполнителем на нескольких шахматках, и поэтому в таблице **worker_project** может быть несколько записей с совпадающими ФИО, телефоном, телеграмом и почтой, но разными project_uuid.  
2. Это нужно для того, чтобы: разные содатели могли именовать исполнителя по-разному в своих шахматках, а также чтобы переименование исполнителя одним пользователем не отражалось на шахматках других пользователей.  

<br> 


### Таблица permissions

_Удаление таблицы_

<br> 

### Таблица role_permission

_Удаление таблицы_

<br> 

### Таблица project_role

_Предложение по составу полей_
Накаких статусов, кроме "активно", у записей нет, поэтому статус можно удалить, а при смене роли пользователя делать UPDATE существующей записи?

_Изменение состава полей_  

| Как сейчас: | Как предлагается: |
| ----------- | ----------------- |
| id          | id                |
| **status**  |                   |
| project_id  | project_id        |
| role_id     | role_id           |
| user_id     | user_id           |
| comment     | comment           |
| created     | created           |`
| updated     | updated           |

<br> 

### Таблица role

_Предложение по составу полей_
- Перейти от serial4 к uuid?
- Удалить поле code?

_Изменение содержимого_
- убрать все, кроме редактора и читателя
- в целом, предлагается также роль "Создатель" - но мы ее отдельно не формализуем, она дает доступ до настроек профиля, создания/удаления объектов, а также редактирования/удаления всех заметок, даже чужих.

| id  | name     | code |
| --- | -------- | ---- |
| 18  | Читатель | RE   |
| 19  | Редактор | ED   |

<br> 

### Таблица user_job_titles

_Новая таблица_  (отделилась от **role**)

- Сразу uuid?
- Не переиспользовать поле code?
- Наполнение: ниже приведены должности, которые нужно будет отразить в селекторе на front-end и, соответственно, положить в таблицу user_job_titles:

| Должность          |
| ------------------ |
| Начальник участка  |
| Прораб             |
| Технический надзор |
| Мастер участка     |
| Сметчик            |
| Инженер ПТО        |


### Проблема 1

**Требуется сложное разграничение доступов, не только по принципу "право на просмотр" / "право редактировать любые разделы"**.  
На одном проекте один и тот же пользователь Х может быть технадзором (оставлять замечания и производить приемку), на другом проекте - фигурировать как исполнитель работ.  
При этом, если пользователь - технадзор на двух проектах, на одном проекте может быть доступ с правом редактирования работ в помещениях (+ заметки), на другом - доступ с правом только на чтение шахматки (+ заметки).  
Если пользователь системы - исполнитель на нескольких проектах (так будет редко, и тогда он все равно по факту и.о. прораба), ему на разных проектах могут выдать доступ с разными правами:

- редактирования шахматки
- редактирования шахматки и справочников (работ, исполнителей), данных дефектовки и др. (бригадир)
- только на перевод работы в статус завершена
- с правом только на просмотр
- другие комбинации.

### Решение 1

1. Cистема должна предоставлять пользователю возможность **гибко настраиваить все доступы для всех пользователей**, являющихся участниками проекта, кроме себя.
2. Cистема должна предоставлять пользователю возможность удобно **просматривать данные по доступам** на проекте.
3. Система должна давать возможность проставлять должности пользователям и dummy-пользователям.
4. Система должна давать возможность просматривать должности пользователей и dummy-пользователям.
5. Должность пользователя напрямую жестко не связана с доступом к функционалу (связь подразуемевается, но не форсируется).
6. При создании пользователя и выборе ему должности права доступа автоматически предзаполняются!
7. В дальнейшем права доступа каждого из пользователей могут быть скорректированы.
8. Доступы существуют только в контексте данного объекта.

Возможная реализация:

- в разделе управления доступами к шахматке представлены категории функциональности;
  - в каждую категорию функциональности можно провалиться и увидеть перечень пользователей, имеющих к ней доступ;
    - в перечне пользователей для каждого пользоватея указываются
      - Телефон
      - ФИО
      - "Должность/Роль"
      - "Комментарий" (видны ± первые 50 символов)
      - Является ли пользователем ("Пользователь" / " " - flag, а может, просто иконка каски, например. потом сможет отображать онлайновость пользователей)
      - ~~измерение, по которому уже и произведена фильтрация - это сами доступы. Это набор из 8 флагов) 
  - в перечене категорий функционала должна быть отражена группа, в которую внесены все НЕ-пользователи и пользователи без доступа к шахматке (т.е. можно быть пользователем, числиться на объекте и при этом не иметь никаких доступов) - функционала у этой группы нет никакого, даже просмотра;
  - в каждой категории функциональности можно добавлять и удалять пользователей, имеющих к ней доступ.
  - ~~в каждого пользователя далее можно провалиться и увидеть профиль со сводной информацией по нему: телефон, ФИО, доступы, должность, комментарий~~
- система поддерживает отображение в виде перечня пользователей, с фильтрацией(поиском);
  - ~~из общего перечня пользователей можно также провалиться в пользователя и увидеть профиль со сводной информацией по нему~~.


У каждого пользователя системы есть поля "Должность" и "Является ли пользователем". В зависимости от их комбинации есть несколько вариантов дефолтного доступа:

Если кто-то не является пользователем, то он не может в системе ничего.
Если "Контакт" тел_1 имеет ссылку на шахматку, он все еще не может ее просмотреть, просто зарегистрировавшись - для этого ему должны быть выданы минимальные права.
Все Контакты, прикрепленные к проекту, зарегистрировавшись, смогут просматривать шахматку (над которой они и работают).
Но в редкатировании справочника исполнители - должно быть четко написано, что вот мол эти люди будут видеть шахматку.

В таблице считаем, что все, кто не прикреплены к объекту через списки (справочники), могут иметь доступ только к просмотру шахматок (со статусами и объемами работ) и к замечаниям.

При этом создатель шахматки всегда может делать все, вплоть до нарядов/реестров и списков

| Должность   | Что может по умолчанию | Комментарий |
|---------------------|----------------------|-----------|
| Контакт (unregistered) | Не может ничего. Может только зарегистрироваться. | - |
| Исполнитель (workman)  | Просмотр чужих шахматок (со статусами и объемами работ) и замечаний | Рабочие будут редко регаться, но если вдруг зарегистрируются, они смогут только читать и менять статус работ, и только если принадлежать к проекту |
| Пользователь или Прораб или Нач. уч. или Технадзор (user, foreman, techman, etc)| Может делать все с чужими шахматками и замечаниями. Работа с нарядами/реестрами и с списками - только по доступу создателя шахматки| |
| ИО (manager) | Режим полной свободны. Может делать с шахматкой все. Не может удалить объект. Не может редактировать наряды и реестры (никто не может). Может выдавать и забирать доступы, кроме создателя, у него на все карт-бланш всегда. |

Могу только я (создатель):
- создание и удаление шахматок в моем профиле
- Пользовательские (свои) настройки меняют только я
- Редактировать наряды и реестры нельзя вообще никому. Даже система этого делать не умеет. Можно только перейти в предыдущую версию и создать новый отчет на ту же дату.

| Функциональность | Комментарий | Кому дефолтно выдаются |
|--------------------|---------------------------------------------------------------------|----|
| Замечания          | Просмотр                                                            | Технадзор |
|                    | - Создание, редактирование (в том управление файламии), удаление замечаний, смена статуса замечания |
| Шахматки (статус и объем работ) | Просмотр                                                            |
|                    | - редактирование                                |
| Списки (aka справочники) | Просмотр                                                      |
|                    | - Создание, редактирование, удаление                                |
| Наряды и реестры   | Просмотр                                                            |
|                    | - Создание, удаление                                |





Только я и создатель шахматки можем создавать замечания и закрывать их. Другие замечания просматривают.
При этом если я исполнитель, то только я и создатель шахматки можем создавать работы и закрывать их. Другие работы просматривают.
Наряды и отчеты вообще никто, кроме пользователя, не видит.

**Проблема 2**: сквозные данные по ФИО - путают пользователяю, потому что это коллективное редактирование.
С точки зрения системы, оно должно быть

**Проблема 3**: чувствительные данные - я может даже и не хочу, чтобы мои данные кто-то видел, кроме начальника-прораба.

Что такое есть должность в нашей системе?
Не более, чем комментарий сейчас. Привязать разграничение доступов к должности можно, но нужно ли?
Так или иначе, лучше словарь должностей завести, если эта должность так уж нужна.
Нужен ли нам внутренний комментарий по всем нашим исполнителям?

Ролевая модель в системе на текущий момент отсутствует. То есть:
Пользователи никак не отличаются в системе друг от друга, даже если обладают разными должностями (прораб, начальник участка, технадзор, бригадир, мастер участка и др.). Во-первых, их функции могут меняться со временем, во-вторых иногда они совмещают разную деятельность. Например, Пользователь может быть
одновременно прорабом и технадзором, не говоря уже о разных ролях на разных объектах.

Основные функции, доступные любому пользователию в своем аккаунте - CRUD-операции для шахматок, нарядов/отчетов/реестров, справочников (работы, технадзоры, исполнители), замечаний, настройка (аккаунт, статусы, виды работ).

При этом надо понимать, что пользователь при формировании реестров на выплату все равно узнает ФИО работников. А вот работникам знать друг друга совсем не обязательно?

Могу ли я как пользователь видеть чувствительные данные исполнителей в шахматках, к которым у меня доступ на чтение? На редактирование?

| Кто | Что хочет | Для чего |
|-----|------|-------|
||||
|| Работа со своими шахматками ||
||||
| User | (!) Видеть полные ФИО своих исполнителей        | Формирование корректных нарядов, реестров, других документов |
| User | (!) Не вводить вручную ФИО своих исполнителей   | Ускорение и упрощение работы с продуктом                     |
| User | Совершать CRUD-операции над справочниками (работ, технадзоров, исполнителей) | Выполнение базовых действий с шахматкой, замечаниями, нарядами |
|      | - Изменять данные исполнителей                | Поддержка актуальной контактной информации - исполнители       |
|      | - Изменять данные технадзоров                 | Поддержка актуальной контактной информации - технадзор         |
| User | Совершать CRUD-операции над шахматками        | Базовая работа с шахматкой                                     |
| User | Совершать CRUD-операции над нарядами          | Базовая работа с нарядами                                      |
| User | Совершать CRUD-операции над замечаниями       | Базовая работа с замечаниями                                   |
| User | (!) НЕ изменяемость моих шахматок третьими лицами  | Не путаться, не терять реальные данные и не подозревать систему в скомпрометирвоанности |
| User | (!) Изменяемость моих шахматок третьими лицами     | Актуализация данных |
| User | (!) НЕ изменяемость моих замечаний третьими лицами | Не путаться, не терять реальные данные и не подозревать систему в скомпрометирвоанности |
| User | (!) Изменяемость моих замечаний третьими лицами    | Актуализация данных                                       |
| User | Давать возможность оставлять замечания как технадзору, так и исполнителю (бригадиру, например) | ?             |
| User | Давать возможность редактировать работы как исполнителю, так и технадзору                      | ?             |
| User | Изменять свои пользовательские настройки           | Поддержка актуальной контактной информации (своей) и персонализация |
| User | НЕ изменяемость моих настроек третьими лицами      | Не путаться, не терять реальные данные и не подозревать систему в скомпрометированности |
| User | Импортировать контакты из телефонной книги         | Быстрое заполнение справочников                         |
| User | Назначать себя исполнителем                        | Для удобства                                            |
| User | Назначать себя тезнадзором                         | Для удобства                                            |
| User | Назначать исполнителем dummy-пользователей         | Для упрощения/ускорения/удобства работы                 |
| User | Назначать исполнителем других пользователей        | Для избежания дублей между dummy- и full-пользователями |

| User | Создавать dummy-исполнителей                       | Для операционного учета, когда телефон человек неизвестен или его ФИО неизвестны, но создать надо |
| System | Превращать dummy-исполнителей в настоящих пользователей | Для того, чтобы впоследствии однозначно идентифицировать и анализировать связи людей, а еще если у нас телефон - не только логин, но и ключ к просто сущности, могут случиться перепутаница в ...  |
право выдавать доступы
|
||||
|| Смотрю чужие шахматки - просмотр ||
||||
| User | НЕ изменяемость моих настроек третьими лицами | Не путаться, не терять реальные данные и не подозревать систему в скомпрометирвоанности |

||||
|| Смотрю чужие шахматки - редактирование ||
||||

||||
|| Другие смотрям мои шахматки - просмотр ||
||||
||||
|| Другие смотрям мои шахматки - редактирование ||
||||
| Non-user | НЕ видимость моих данных никому, кроме непосредственного руководителя/прораба !!! | Сохранение конфиденциальности        |
| Non-user | Видимость моих данных всем                                                    !!! | Оперативное решение рабочих вопросов |
| System | Обеспечить возможность передавать все данные пользователей третьим лицам в неограниченном количестве | Юридическая чистота |

Пользователь всегда может менять свои системные настройки
Пользователь никогда может менять чужие системные настройки
При этом пользователь хочет всегда помечать другие телефоны так, как удобно ему. При этом чем ближе этот никнейм к реальному имени, тем меньше проблем с документами.
Но и бегать уточнять, как кого зовут, пользователь не хочет. Он хочет обозвать исполнителя как угодно. Потому через интеграцию с 1С надо нужны будут реальные имена.
Я могу хотеть дать возможность исполнителю вносить правки в работы на шахматке, но не вносить в замечания
Я могу хотеть дать возможность технадзорв вносить правки в замечния на шахматке, но не вносить в работы
Корректировать замечания может только их создатель или создатель шахматки.
Права на редактирование справочников должно быть отдельной вещью. Особенно работ
